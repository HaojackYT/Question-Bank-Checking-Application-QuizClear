<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Exam Management</title>
    <link rel="stylesheet" th:href="@{/Static/fontawesome/css/all.css}">
    <link rel="stylesheet" th:href="@{/Static/header.css}">
    <link rel="stylesheet" th:href="@{/Static/web_styles.css}">
    <link rel="stylesheet" th:href="@{/Static/Menu-Staff.css}">
    <link rel="stylesheet" th:href="@{/Static/css/staff/staffExamManagement_All_Exams.css}">
    <link href="https://fonts.googleapis.com/css2?family=RocknRoll+One&display=swap" rel="stylesheet">
</head>
<body>
<header class="header" th:insert="~{header_user :: header}"></header>
<div id="Container-body">
    <div id="menu-HTML" th:insert="~{Menu-Staff :: menu}"></div>
    <div id="main">
        <div class="exam-management">
            <div class="header-container">
                <div class="header-text">
                    <h2>Exam Management</h2>
                    <p>Create, review, and manage exams across all subjects</p>
                </div>
                <a class="create-exam-btn" th:href="@{/staff/exams/create/step1}">
                    <i class="fas fa-plus"></i>
                    Create New Exam
                </a>
            </div>
            
            <!-- Statistics Cards -->
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-number" th:text="${totalExams}">128</div>
                    <div class="stat-label">Total Exams</div>
                    <div class="stat-change">+6.2% from last month</div>
                </div>
                <div class="stat-card pending">
                    <div class="stat-number" th:text="${pendingCount}">24</div>
                    <div class="stat-label">Pending Approval</div>
                    <div class="stat-urgent">(2 urgent due in 48h)</div>
                </div>
                <div class="stat-card approved">
                    <div class="stat-number" th:text="${approvedCount}">96</div>
                    <div class="stat-label">Approved</div>
                    <div class="stat-description">Ready for distribution</div>
                </div>
                <div class="stat-card rejected">
                    <div class="stat-number" th:text="${rejectedCount}">8</div>
                    <div class="stat-label">Rejected</div>
                    <div class="stat-description">Needs revision</div>
                </div>
            </div>

            <!-- Search and Filters -->
            <div class="search-filter-container">
                <form class="search-form" method="get" th:action="@{/staff/exams/all-exams}">
                    <div class="search-input-container">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" name="search" placeholder="Search exams..." 
                               class="search-input" th:value="${search}">
                    </div>
                    
                    <div class="filter-controls">
                        <select name="status" class="filter-select">
                            <option value="">All Statuses</option>
                            <option th:each="s : ${statuses}" th:value="${s.value}" th:text="${s.displayName}" 
                                th:selected="${selectedStatus} == ${s.value}"></option>
                        </select>
                        
                        <select name="department" class="filter-select">
                            <option value="">All Subjects</option>
                            <option th:each="d : ${departments}" th:value="${d}" th:text="${d}" 
                                th:selected="${selectedDepartment} == ${d}"></option>
                        </select>
                        
                        <button type="submit" class="filter-btn">
                            <i class="fas fa-filter"></i>
                        </button>
                    </div>
                </form>
            </div>

            <!-- Navigation Tabs -->
            <div class="tab-navigation">
                <a class="nav-tab active" th:href="@{/staff/exams/all-exams}">All Exams</a>
                <a class="nav-tab" th:href="@{/staff/exams/pending-approval}">Pending Approval</a>
                <a class="nav-tab" th:href="@{/staff/exams/approved}">Approved</a>
                <a class="nav-tab" th:href="@{/staff/exams/needs-revision}">Needs Revision</a>
            </div>

            <!-- Content Header -->
            <div class="content-header">
                <h3>All Exams</h3>
                <p>Manage all exams in the system</p>
            </div>

            <!-- Exam List -->
            <div class="exam-grid">
                <div th:each="exam : ${exams}" class="exam-card">
                    <div class="exam-header">
                        <div class="exam-status" 
                             th:classappend="${exam.status == 'Approved'} ? 'approved' :
                                           (${exam.status == 'Rejected'} ? 'rejected' : 'pending')">
                            <i class="fas" 
                               th:classappend="${exam.status == 'Approved'} ? 'fa-check-circle' :
                                             (${exam.status == 'Rejected'} ? 'fa-times-circle' : 'fa-clock')"></i>
                            <span th:text="${exam.status}">Pending</span>
                        </div>
                        <div class="exam-actions">
                            <a th:href="@{'/staff/exams/' + ${exam.examId} + '/overview-questions'}" 
                               class="action-btn view-btn">View</a>
                            <a th:if="${exam.status == 'Submitted for Review'}" 
                               th:href="@{'/staff/exams/' + ${exam.examId} + '/review'}" 
                               class="action-btn review-btn">Review</a>
                        </div>
                    </div>
                    
                    <div class="exam-content">
                        <h4 class="exam-title" th:text="${exam.examTitle}">Data Structures Final</h4>
                        <div class="exam-meta">
                            <span class="exam-subject" th:text="${exam.subject}">Computer Science</span>
                            <span class="exam-date">
                                Created: <span th:text="${#temporals.format(exam.createdAt, 'yyyy-MM-dd')}">2023-06-15</span>
                            </span>
                            <span th:if="${exam.dueDate != null}" class="exam-due">
                                Due: <span th:text="${#temporals.format(exam.dueDate, 'yyyy-MM-dd')}">2023-06-20</span>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>