<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" th:href="@{/Static/fontawesome/css/all.css}">
    <link rel="stylesheet" th:href="@{/Static/header.css}">
    <link rel="stylesheet" th:href="@{/Static/web_styles.css}">
    <link rel="stylesheet" th:href="@{/Static/css/Lecturer/leturer_ExamEvaluation.css}">
    <link href="https://fonts.googleapis.com/css2?family=RocknRoll+One&display=swap" rel="stylesheet">
    <title>Exam Evaluation</title>
    <!--Task & Exam-->
</head>

<body>
    <!--header-->
    <div th:replace="header_user"></div>

    <!-- body -->
    <div id="Container-body">
        <!-- Menu -->
        <div th:replace="Lecturer/Menu-Lecturer"></div>


        <!-- Main content -->
        <div id="main">
            <!-- noi dung duoc nhap trong day -->
            <div class="exam-evaluation-container">
                <h1 class="page-title">Exam Evaluation</h1>

                <div class="tab-search-wrapper">
                    <div class="nav-tabs">
                        <a href="lecturerEETaskExam"><button class="tab-btn active">Task Exams</button></a>
                        <a href="lecturerEETestFeedback"><button class="tab-btn ">Test & Feedback</button></a>
                        <a href="lecturerEETestRepository"><button class="tab-btn">Test
                                Repository</button></a>
                    </div>

                    <div class="search-container">
                        <input type="text" placeholder="Search questions..." class="search-input">
                        <i class="fas fa-search search-icon"></i>
                    </div>
                </div>

                <div class="exam-table-container">
                    <table class="exam-table">
                        <thead>
                            <tr>
                                <th>Subject</th>
                                <th>Description</th>
                                <th>Total question</th>
                                <th>Deadline</th>
                                <th>Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Database Systems</td>
                                <td>Middle exam</td>
                                <td>20</td>
                                <td>20/05/2023</td>
                                <td><span class="status-badge submitted">Submitted</span></td>
                                <td>
                                    <button class="action-btn" onclick="showInfoModal()"><i
                                            class="fas fa-search"></i></button>
                                    <button class="action-btn"><i class="fas fa-paper-plane"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>Database Systems</td>
                                <td>Middle exam</td>
                                <td>20</td>
                                <td>20/05/2023</td>
                                <td><span class="status-badge Inprogress">In Progress</span></td>
                                <td>
                                    <button class="action-btn" onclick="showInfoModal()"><i
                                            class="fas fa-search"></i></button>
                                    <button class="action-btn"><i class="fas fa-paper-plane"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>Database Systems</td>
                                <td>Middle exam</td>
                                <td>20</td>
                                <td>20/05/2023</td>
                                <td><span class="status-badge Not_received">Not Received</span></td>
                                <td>
                                    <button class="action-btn" onclick="showInfoModal()"><i
                                            class="fas fa-search"></i></button>
                                    <button class="action-btn"><i class="fas fa-paper-plane"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>Database Systems</td>
                                <td>Middle exam</td>
                                <td>20</td>
                                <td>20/05/2023</td>
                                <td><span class="status-badge Inprogress">In Progress</span></td>
                                <td>
                                    <button class="action-btn" onclick="showInfoModal()"><i
                                            class="fas fa-search"></i></button>
                                    <button class="action-btn"><i class="fas fa-paper-plane"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>Database Systems</td>
                                <td>Middle exam</td>
                                <td>20</td>
                                <td>20/05/2023</td>
                                <td><span class="status-badge Inprogress">In Progress</span></td>
                                <td>
                                    <button class="action-btn" onclick="showInfoModal()"><i
                                            class="fas fa-search"></i></button>
                                    <button class="action-btn"><i class="fas fa-paper-plane"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>Database Systems</td>
                                <td>Middle exam</td>
                                <td>20</td>
                                <td>20/05/2023</td>
                                <td><span class="status-badge Inprogress">In Progress</span></td>
                                <td>
                                    <button class="action-btn" onclick="showInfoModal()"><i
                                            class="fas fa-search"></i></button>
                                    <button class="action-btn"><i class="fas fa-paper-plane"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>Database Systems</td>
                                <td>Middle exam</td>
                                <td>20</td>
                                <td>20/05/2023</td>
                                <td><span class="status-badge Not_received">Not Received</span></td>
                                <td>
                                    <button class="action-btn" onclick="showInfoModal()"><i
                                            class="fas fa-search"></i></button>
                                    <button class="action-btn"><i class="fas fa-paper-plane"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>Database Systems</td>
                                <td>Middle exam</td>
                                <td>20</td>
                                <td>20/05/2023</td>
                                <td><span class="status-badge submitted">Submitted</span></td>
                                <td>
                                    <button class="action-btn" onclick="showInfoModal()"><i
                                            class="fas fa-search"></i></button>
                                    <button class="action-btn"><i class="fas fa-paper-plane"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>Database Systems</td>
                                <td>Middle exam</td>
                                <td>20</td>
                                <td>20/05/2023</td>
                                <td><span class="status-badge submitted">Submitted</span></td>
                                <td>
                                    <button class="action-btn" onclick="showInfoModal()"><i
                                            class="fas fa-search"></i></button>
                                    <button class="action-btn"><i class="fas fa-paper-plane"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>Database Systems</td>
                                <td>Middle exam</td>
                                <td>20</td>
                                <td>20/05/2023</td>
                                <td><span class="status-badge submitted">Submitted</span></td>
                                <td>
                                    <button class="action-btn" onclick="showInfoModal()"><i
                                            class="fas fa-search"></i></button>
                                    <button class="action-btn"><i class="fas fa-paper-plane"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>Database Systems</td>
                                <td>Middle exam</td>
                                <td>20</td>
                                <td>20/05/2023</td>
                                <td><span class="status-badge Not_received">Not Received</span></td>
                                <td>
                                    <button class="action-btn" onclick="showInfoModal()"><i
                                            class="fas fa-search"></i></button>
                                    <button class="action-btn"><i class="fas fa-paper-plane"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>Database Systems</td>
                                <td>Middle exam</td>
                                <td>20</td>
                                <td>20/05/2023</td>
                                <td><span class="status-badge  Not_received">Not Received</span></td>
                                <td>
                                    <button class="action-btn" onclick="showInfoModal()"><i
                                            class="fas fa-search"></i></button>
                                    <button class="action-btn"><i class="fas fa-paper-plane"></i></button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Information Modal -->
            <div id="infoModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Information</h2>
                        <span class="close" onclick="closeInfoModal()">&times;</span>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label>Requester</label>
                            <input type="text" value="Nguyễn A" readonly>
                        </div>
                        <div class="form-group">
                            <label>Deadline</label>
                            <input type="text" value="15/8/2028" readonly>
                        </div>
                        <div class="form-group">
                            <label>Subject</label>
                            <input type="text" value="Database System" readonly>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <input type="text" value="Middle exam" readonly>
                        </div>
                        <div class="form-row">
                            <div class="form-group half">
                                <label>Total Question</label>
                                <input type="text" value="90" readonly>
                            </div>
                            <div class="form-group half">
                                <label>Test Duration</label>
                                <input type="text" value="90:00" readonly>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group quarter">
                                <label>Remember</label>
                                <div class="count-box">40</div>
                            </div>
                            <div class="form-group quarter">
                                <label>Understand</label>
                                <div class="count-box">20</div>
                            </div>
                            <div class="form-group quarter">
                                <label>Apply (basic)</label>
                                <div class="count-box">15</div>
                            </div>
                            <div class="form-group quarter">
                                <label>Apply (advanced)</label>
                                <div class="count-box">15</div>
                            </div>
                        </div>
                        <button class="accept-btn">Accept task</button>
                    </div>
                </div>

            </div>
        </div>

        <!-- ma nhung header vs menu -->
        <script>
            // Load header
            fetch('../../Template/header_user.html')
                .then(response => response.text())
                .then(data => {
                    document.getElementById('header-placeholder').innerHTML = data;
                });

            // Load menu
            fetch('Menu-Lecturer.html')
                .then(response => response.text())
                .then(data => {
                    document.getElementById('menu-HTML').innerHTML = data;
                    setActiveMenu(document.title);
                });

            function showInfoModal() {
                document.getElementById('infoModal').style.display = 'block';
            }

            function closeInfoModal() {
                document.getElementById('infoModal').style.display = 'none';
            }

            // Close modal when clicking outside
            window.onclick = function (event) {
                const modal = document.getElementById('infoModal');
                if (event.target == modal) {
                    modal.style.display = 'none';
                }
            }
            document.addEventListener('DOMContentLoaded', function () {
                // Lấy tất cả các nút có class 'action-btn' chứa icon fa-paper-plane
                const actionButtons = document.querySelectorAll('.action-btn i.fa-paper-plane');

                // Gắn sự kiện click cho từng nút
                actionButtons.forEach(button => {
                    button.parentElement.addEventListener('click', function () {
                        // Chuyển hướng đến trang lectureEETaskExamCreateExam.html
                        window.location.href = 'lectureEETaskExamCreateExam';
                    });
                });
            });
        </script>
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                const rows = document.querySelectorAll('.exam-table tbody tr');
                const acceptButton = document.querySelector('.accept-btn');
                let currentRow = null;

                // Hàm cập nhật trạng thái nút Accept dựa trên status-badge
                function updateAcceptButton(status) {
                    if (status === 'Not Received') {
                        acceptButton.style.opacity = '1';
                        acceptButton.disabled = false;
                    } else {
                        acceptButton.style.opacity = '0.5';
                        acceptButton.disabled = true;
                    }
                }

                // Gắn sự kiện cho nút Search (fa-search) để lưu hàng hiện tại và cập nhật nút Accept
                rows.forEach(row => {
                    const searchButton = row.querySelector('.action-btn i.fas.fa-search');
                    searchButton.parentElement.addEventListener('click', function () {
                        currentRow = row;
                        const status = row.querySelector('.status-badge').textContent.trim();
                        showInfoModal();
                        updateAcceptButton(status);
                    });
                });

                // Xử lý sự kiện nhấn nút Accept
                acceptButton.addEventListener('click', function () {
                    if (currentRow) {
                        const statusBadge = currentRow.querySelector('.status-badge');
                        if (statusBadge.textContent.trim() === 'Not Received') {
                            // Cập nhật trạng thái thành In Progress
                            statusBadge.textContent = 'In Progress';
                            statusBadge.className = 'status-badge in-progress';
                            // Làm mờ nút Accept và vô hiệu hóa
                            acceptButton.style.opacity = '0.5';
                            acceptButton.disabled = true;
                            // Đóng modal
                            closeInfoModal();
                            alert('Nhiệm vụ đã được chấp nhận và chuyển sang trạng thái In Progress.');
                        }
                    }
                });
            });

            document.addEventListener('DOMContentLoaded', function () {
                const searchInput = document.querySelector('.search-input');
                const rows = document.querySelectorAll('.exam-table tbody tr');

                searchInput.addEventListener('input', function () {
                    const searchText = this.value.trim().toLowerCase();

                    rows.forEach(row => {
                        const subject = row.querySelector('td:nth-child(1)').textContent.trim().toLowerCase();
                        const description = row.querySelector('td:nth-child(2)').textContent.trim().toLowerCase();

                        // Kiểm tra nếu Subject hoặc Description chứa searchText
                        if (subject.includes(searchText) || description.includes(searchText)) {
                            row.style.display = ''; // Hiển thị hàng
                        } else {
                            row.style.display = 'none'; // Ẩn hàng
                        }
                    });
                });
            });
        </script>
        <script src="../../Static/js/L_activeMenu.js"></script>
</body>

</html>